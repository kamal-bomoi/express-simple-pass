extends base

mixin Alert(type)
  div.alert(class=type)
    block

block children
  - const path = redirect && redirect.startsWith("/") && !redirect.startsWith("//") ? redirect : "";
  - const q = path ? `?redirect=${encodeURIComponent(path)}` : "";

  div.container
    div.header
      h3.title= labels.title || "Authentication"
      p.instruction= type === "passkey" ? labels.instruction || "Enter the pass key to continue" : labels.instruction || "Enter your credentials to continue"

    if error
      +Alert("error")= error

    if unpassed === true
      +Alert("success")= labels.logged_out || "You have been logged out."

    form(method="post", action=`${rootpath}${q}`)
      div.fields
        if type === "email-password"
          div.fields-group
            input#email.input(
              type="email",
              name="email",
              placeholder=labels.email_placeholder === undefined ? "Email" : labels.email_placeholder,
              value=email || "",
              required,
              autofocus
            )
            input#password.input(
              type="password",
              name="password",
              placeholder=labels.password_placeholder === undefined ? "Password" : labels.password_placeholder,
              required
            )
        else
          input#passkey.input(
            type="password",
            name="passkey",
            placeholder=labels.passkey_placeholder === undefined ? "Pass key" : labels.passkey_placeholder,
            required,
            autofocus
          )

      div.actions
        button(type="submit")= labels.submit || "Submit"

    form.logout-form(method="post", action=`${rootpath}/_logout${q}`)
      button.logout(type="submit")= labels.logout || "Log out"
